---
const { scores } = Astro.props;
const chartId = "radar-" + Math.random().toString(36).slice(2);
---

<div class="w-full h-80">
  <canvas
    id={chartId}
    data-scores={JSON.stringify(scores)}
  ></canvas>
</div>

<script define:vars={{ chartId }}>
  import("chart.js/auto").then(({ default: Chart }) => {
    const canvas = document.getElementById(chartId);

    if (!canvas) {
      console.error("RadarChart: no container found");
      return;
    }

    const scores = JSON.parse(canvas.dataset.scores);
    const ctx = canvas.getContext("2d");

    new Chart(ctx, {
      type: "radar",
      data: {
        labels: ["Ingredientes", "Nutrición", "Palatabilidad", "Calidad/Precio"],
        datasets: [
          {
            label: "Puntuación",
            data: [
              scores.ingredients,
              scores.nutrition,
              scores.palatability,
              scores.priceQuality,
            ],
            backgroundColor: "rgba(59,130,246,0.3)",
            borderColor: "rgba(59,130,246,1)",
            borderWidth: 2,
            pointBackgroundColor: "rgba(59,130,246,1)",
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        scales: {
          r: {
            suggestedMin: 0,
            suggestedMax: 5,
          }
        }
      }
    });
  });
</script>
