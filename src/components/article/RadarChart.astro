---
import type { Props } from "./RadarChart.astro";

const { scores } = Astro.props;
const chartContainerId = "radar-" + Math.random().toString(36).substring(2);
---

<div id={chartContainerId} class="w-full h-80"></div>

<script>
  const scores = Astro.props.scores;
  const chartContainerId = "{{chartContainerId}}";

  import("chart.js/auto").then(({ default: Chart }) => {
    const ctx = document.getElementById(chartContainerId);

    if (!ctx) {
      console.error("RadarChart: no se encontró el canvas");
      return;
    }

    new Chart(ctx, {
      type: "radar",
      data: {
        labels: ["Ingredientes", "Nutrición", "Palatabilidad", "Calidad/Precio"],
        datasets: [
          {
            label: "Puntuación",
            data: [
              scores.ingredients,
              scores.nutrition,
              scores.palatability,
              scores.priceQuality,
            ],
            backgroundColor: "rgba(59,130,246,0.3)",
            borderColor: "rgba(59,130,246,1)",
            borderWidth: 2,
            pointBackgroundColor: "rgba(59,130,246,1)",
          },
        ],
      },
      options: {
        scales: {
          r: {
            suggestedMin: 0,
            suggestedMax: 5,
          },
        },
      },
    });
  });
</script>
