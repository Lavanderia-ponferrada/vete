---
const { scores } = Astro.props;
const chartId = "radar-" + Math.random().toString(36).slice(2);
---

<!-- PONEMOS LOS SCORES EN DATA-*, QUE SIEMPRE FUNCIONA -->
<div 
  id={chartId} 
  class="w-full h-80"
  data-scores={JSON.stringify(scores)}
></div>

<script>
  import("chart.js/auto").then(({ default: Chart }) => {
    const el = document.getElementById("{{chartId}}");

    if (!el) {
      console.error("RadarChart: no container found");
      return;
    }

    // Recuperamos los scores desde data-scores
    const scores = JSON.parse(el.dataset.scores);

    const ctx = el;

    new Chart(ctx, {
      type: "radar",
      data: {
        labels: ["Ingredientes", "Nutrición", "Palatabilidad", "Calidad/Precio"],
        datasets: [
          {
            label: "Puntuación",
            data: [
              scores.ingredients,
              scores.nutrition,
              scores.palatability,
              scores.priceQuality,
            ],
            backgroundColor: "rgba(59,130,246,0.3)",
            borderColor: "rgba(59,130,246,1)",
            borderWidth: 2,
            pointBackgroundColor: "rgba(59,130,246,1)",
          }
        ]
      },
      options: {
        scales: {
          r: {
            suggestedMin: 0,
            suggestedMax: 5,
          }
        }
      }
    });
  });
</script>
